(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1e64fe6"],{"3f5e":function(e,t,i){"use strict";i.d(t,"c",(function(){return l})),i.d(t,"e",(function(){return o})),i.d(t,"f",(function(){return r})),i.d(t,"d",(function(){return c})),i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return d}));i("d3b7");var s=i("b775"),a=i("bc3a"),n=i.n(a);function l(e){return Object(s["a"])({url:"/Admin/Ftp/GetFtpItems",method:"post",data:e})}function o(e){return Object(s["a"])({timeout:6e4,url:"/Admin/Ftp/UpLoadFile",method:"post",data:e})}function r(e,t){return new Promise((function(i,s){n()({baseURL:"/prod-api",method:"Post",headers:{},url:"/Admin/UploadFile/UpLoadFile",params:t,data:e}).then((function(e){i(e.data)})).catch((function(e){s(e)}))}))}function c(e){return Object(s["a"])({url:"/Admin/UploadFile/GetUploadFileList",method:"post",data:e,params:e})}function u(e){return new Promise((function(t,i){n()({baseURL:"/prod-api",method:"Post",headers:{},url:"/Admin/UploadFile/DownloadFile",params:{},data:e,responseType:"blob"}).then((function(e){t(e)})).catch((function(e){i(e)}))}))}function d(e){return Object(s["a"])({url:"/Admin/UploadFile/DeleteFile",method:"delete",data:e})}},"75e7":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"Host",clearable:""},model:{value:e.listQuery.host,callback:function(t){e.$set(e.listQuery,"host",t)},expression:"listQuery.host"}}),i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"user",clearable:""},model:{value:e.listQuery.user,callback:function(t){e.$set(e.listQuery,"user",t)},expression:"listQuery.user"}}),i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"password",clearable:""},model:{value:e.listQuery.password,callback:function(t){e.$set(e.listQuery,"password",t)},expression:"listQuery.password"}}),i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"port",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.port,callback:function(t){e.$set(e.listQuery,"port",t)},expression:"listQuery.port"}}),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-link"},on:{click:e.handleFilter}},[e._v(" 连接 ")]),i("el-container",{staticClass:"mylayout"},[i("el-aside",[i("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"tree",attrs:{width:"300px",data:e.treeData,props:e.defaultProps,"default-expand-all":""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.data;return i("span",{staticClass:"span-ellipsis"},[i("i",{class:["File"===s.type?"el-icon-document":[1==s.type?"el-icon-folder-opened":"el-icon-document"]]}),i("span",{attrs:{title:s.fullName}},[e._v(e._s(s.fullName))])])}}])})],1),i("el-container",[i("el-header",{staticStyle:{height:"50px","text-align":"left","font-size":"12px"}},[i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-folder-opened"},on:{click:e.handleBack}},[e._v(" 上级目录 ")]),i("label",{staticClass:"label"},[e._v(e._s(e.currentDirectory))])],1),i("el-main",[i("el-upload",{ref:"upload1",staticClass:"upload-demo",attrs:{action:"/Admin/Ftp/UpLoadFile",disabled:e.disabledUpload,"auto-upload":!1,"on-change":e.changeFile,"on-exceed":e.handleExceed,"file-list":e.fileList1,data:e.fileData,"list-type":"picture",drag:"",multiple:"","show-file-list":!1,limit:1e3}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text",staticStyle:{"margin-top":"-10px","line-height":"20px"}},[e._v(" 将文件拖到此处，"),e.disabledUpload?i("em",[e._v("（文件正在上传中，请等待...）")]):i("em",[e._v("或点击上传(单个文件需小于100M,一次最多上传1000个文件)")])])]),e.showPercent?i("el-progress",{attrs:{percentage:Number((100*e.percentNow/e.percentTotal).toFixed(0))}}):e._e()],1)],1)],1)],1)])},a=[],n=i("b85c"),l=(i("498a"),i("b0c0"),i("e9c4"),i("99af"),i("4381")),o=i("6724"),r=i("3f5e"),c=i("ed08"),u={name:"Ftp",directives:{waves:o["a"],permission:l["a"]},data:function(){return{treeLoading:!1,listQuery:{host:"",user:"",password:"",port:"21",workingDirectory:""},treeData:[],defaultProps:{children:"children",label:"field"},currentDirectory:"/",iconFile:"el-icon-document",iconfolder:"el-icon-folder-opened",fileList:[],formData:void 0,upFileList:[],percentTotal:0,percentNow:0,showDesc:"",showPercent:!1,time:null,disabledUpload:!1,fileData:{},fileList1:[]}},computed:{},created:function(){this.listQuery=Object(c["g"])("ftp")||this.listQuery},methods:{handleFilter:function(){this.listQuery.workingDirectory="",this.getList()},getList:function(){var e=this;this.treeLoading=!0,Object(r["c"])(this.listQuery).then((function(t){e.treeData=JSON.parse(t.data),e.treeLoading=!1,Object(c["h"])("ftp",e.listQuery)})).catch((function(){e.treeData=[],e.treeLoading=!1}))},handleNodeClick:function(e){console.log(e),this.listQuery.workingDirectory=e.fullName,this.currentDirectory=e.fullName,0===e.type?console.log(11):1===e.type&&this.getList()},handleBack:function(){this.listQuery.workingDirectory=this.currentDirectory.trim().substr(0,this.currentDirectory.trim().lastIndexOf("/")),this.currentDirectory=this.listQuery.workingDirectory,this.getList()},changeFile:function(e,t){var i=this;this.disabledUpload=!0,console.log("changeFile",e,t);var s=e.size/1024/1024<100;s||this.$message.warning("上传文件大小不能超过 100M"),this.upFileList=[];var a,l=Object(n["a"])(t);try{for(l.s();!(a=l.n()).done;){var o=a.value;o.raw&&o.size/1024/1024<100&&(this.upFileList.push(o.raw),this.percentTotal=this.upFileList.length,this.percentNow=0,this.showPercent=!1,this.showDesc="")}}catch(r){l.e(r)}finally{l.f()}clearTimeout(this.time),this.time=setTimeout((function(){i.time=null,console.log("防抖 高频触发后n秒内只会执行一次  再次触发重新计时"),i.fnBegin()}),1500)},fnBegin:function(){console.log("此时change了所有文件 开始上传",this.upFileList),this.submitUpload2()},submitUpload2:function(){var e=this;if(console.log(this.upFileList.length),!(this.upFileList.length>0))return this.disabledUpload=!1,this.showPercent=!1,this.upFileList=[],this.$refs.upload1.clearFiles(),this.fileList1=[],this.percentNow===this.percentTotal&&this.percentTotal?(this.$message.success(this.showDesc?this.showDesc:"已全部上传成功！"),this.percentTotal=0,this.percentNow=0,this.showDesc=""):this.percentNow===this.percentTotal&&0===this.percentTotal?(this.$message.warning("请先选择文件！"),this.percentTotal=0,this.percentNow=0):(this.$message.success("已部分上传成功，且取消后续文件上传！"),this.percentTotal=0,this.percentNow=0),!1;this.showPercent=!0,this.formData=new FormData,this.formData.append("file",this.upFileList[0]),this.formData.append("name",this.upFileList[0].name),this.formData.append("info",JSON.stringify(this.listQuery));var t=this;Object(r["e"])(this.formData).then((function(i){e.percentNow=e.percentNow+1,e.upFileList.shift(),console.log("上传返回",i),i.data.success||(t.$message({message:i.data||"上传失败",type:"error"}),e.showDesc="上传结束，部分文件上传失败"),e.submitUpload2()})).catch((function(i){console.log(i),t.$message({message:i||"上传失败",type:"error"}),e.percentNow=e.percentNow+1,e.upFileList.shift(),e.showDesc="上传结束，部分文件上传失败",e.submitUpload2()}))},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择 100 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))}}},d=u,p=(i("eb3c"),i("2877")),h=Object(p["a"])(d,s,a,!1,null,null,null);t["default"]=h.exports},ddb9:function(e,t,i){},eb3c:function(e,t,i){"use strict";i("ddb9")}}]);